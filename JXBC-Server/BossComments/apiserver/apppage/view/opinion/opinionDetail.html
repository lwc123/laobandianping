<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>点评详情</title>
		<meta name="description" content=""/>
		<!--清理缓存 start-->
		<meta HTTP-EQUIV="pragma" CONTENT="no-cache">
		<meta HTTP-EQUIV="Cache-Control" CONTENT="no-cache, must-revalidate">
		<meta HTTP-EQUIV="expires" CONTENT="Wed, 26 Feb 1997 08:21:57 GMT">
		<meta content="telephone=no" name="format-detection" />
		<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<link href="{$Think.config.resources_site_root}/mobile/css/style.css?v=0" rel="stylesheet">
		<script src="{$Think.config.resources_site_root}/mobile/js/flexible.js"></script>
	</head>
	<body>
		<!--头部-->
		{if(!empty($Think.get.Code))}
		<div id="pageHead" class="listHead">
			<svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3073"><path d="M738.145103 170.248828 663.234207 95.337931 313.114483 445.457655 312.937931 445.298759 238.768552 519.450483 238.945103 519.627034 238.768552 519.785931 313.679448 594.696828 313.838345 594.537931 658.996966 939.696552 733.166345 865.509517 388.007724 520.368552Z" p-id="3074"></path></svg>
			<b class="font34">点评详情</b>
		</div>
		{/if}
		<input type="hidden" id="hasCode" value="{$Think.get.Code}">
		<div class="comments opinionDetail">
		  <!--匿名用户评价-->
		  <div class="user">
			  <div class="userDetail overflow padding">
			     <img class="fl photo" src="{$Think.config.resources_site_root}/mobile/img/logo.png">
			     <div class="user fl">
			        <h3 class="font30">{if(!empty($OpinionDetail.NickName))}{$OpinionDetail.NickName}{else/}匿名用户{/if}</h3>
			        <p class="grey">
                        {if($OpinionDetail.WorkingYears<0)}
                        来自员工-{$OpinionDetail.WorkingYears|abs}年{if(!empty($val.Region))}-{$OpinionDetail.Region}{/if}
                        {else/}
                        来自前员工-{$OpinionDetail.WorkingYears}年{if(!empty($OpinionDetail.Region))}-{$OpinionDetail.Region}{/if}
                        {/if}
                    </p>
			     </div>
			     <div class="userScore fr">
			         <b class="font24 fl"></b>
			         <div class="showStar">
			             <span tip="{$OpinionDetail.Scoring}"></span>
				         <a herf="javascript:void(0)"></a>
				         <a herf="javascript:void(0)"></a>
				         <a herf="javascript:void(0)"></a>
				         <a herf="javascript:void(0)"></a>
				         <a herf="javascript:void(0)"></a>
			         </div> 
			     </div>
			  </div>
			  <div class="userComment padding">
			      <div class="userLabel">
                      {if(!empty($OpinionDetail.Labels))}
                      {foreach($OpinionDetail.Labels as $key=>$vals)}
                      <span>{$vals}</span>
                      {/foreach}
                      {/if}
			 	  </div>
			 	  <div class="userContent">
			 	      <b class="font30">{$OpinionDetail.Title}</b>
			 	      <p class="font24 top">{$OpinionDetail.Content}</p>
			 	      <ul>
			 	        <li>
                            我{if($OpinionDetail.Recommend==50)}不{/if}愿意推荐朋友来这家公司
                        </li>
			 	        <li>
                            我{if($OpinionDetail.Optimistic==50)}不看好{elseif($OpinionDetail.Optimistic==80)}观望{else/}看好{/if}公司未来发展前景
                        </li>
			 	        <li>
                            我{if($OpinionDetail.SupportCEO==50)}不{/if}支持CEO
                        </li>
			 	      </ul>
			 	      <span class="grey">{:toLocalDateTime($OpinionDetail['LastReplyTime'],'Y年m月d日')}</span>
			 	      <div class="pingNum fr">
				 	      <span class="grey read">阅读{$OpinionDetail.ReadCount}</span>
                          <span     {if(!empty($OpinionDetail.IsLiked) && $OpinionDetail.IsLiked==true)} class="zan" {else/} class="grey zan" {/if}>
                          <svg OpinionId="{$OpinionDetail.OpinionId}"  class="icon font34" style="width: 1em; height: 1em;vertical-align: top;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3213"><path d="M188.672 471.36c14.4 0 25.770667-8.981333 25.770667-23.36s-11.413333-22.613333-25.813333-22.613333c-0.277333 0-0.490667 0.170667-0.746667 0.170667l-62.314667 0.128c-1.429333-0.213333-2.901333-0.298667-4.373333-0.298667-19.626667 0-35.861333 16.085333-35.861333 36.010667l0 441.344c0 19.882667 15.936 35.498667 35.562667 35.498667 1.898667 0 3.797333 0.298667 5.632 0l60.842667 0c0.106667 0 0.149333 0.085333 0.256 0.085333s0.149333-0.085333 0.234667-0.085333l0.746667 0 0-0.128c13.376-0.533333 24.106667-8.384 24.106667-21.866667 0-13.546667-10.730667-21.717333-24.106667-22.250667l0-0.426667L128 893.568l0-422.229333 60.608 0L188.672 471.338667zM927.68 421.333333c-10.069333-11.968-22.613333-14.997333-46.954667-15.658667l-248.469333 0.341333c36.650667-84.928 47.744-194.666667 9.962667-267.477333-17.066667-32.896-54.208-53.589333-87.552-53.184-64.896 0.768-90.453333 47.530667-101.269333 106.24-14.741333 80.021333-92.714667 223.168-197.397333 235.093333l0 511.893333 490.666667-0.021333 8.725333-0.256c19.306667 0.042667 44.544 2.56 62.058667-8.725333 20.672-12.010667 20.885333-33.642667 28.074667-60.565333 0 0 69.888-297.941333 88.896-383.808C941.333333 454.037333 939.178667 435.008 927.68 421.333333zM795.413333 874.56l-0.106667-0.042667c-2.624 6.378667-7.061333 12.010667-13.205333 16-4.288 2.837333-9.002667 4.501333-13.76 5.162667-1.536-0.213333-3.114667 0-4.736 0l-464.938667 0.213333L298.666667 469.333333c56-22.229333 110.314667-72.085333 148.714667-139.648 30.186667-53.098667 37.504-78.954667 48.661333-127.296 14.677333-63.552 34.197333-73.877333 58.624-73.877333 23.104 0 60.672 15.658667 67.989333 106.730667 5.354667 66.752-29.162667 137.344-38.784 172.949333-1.344 4.970667-3.093333 20.992 7.552 30.677333 12.245333 11.114667 36.821333 9.130667 48.576 9.130667l220.010667-0.341333c12.458667-0.661333 25.322667 1.557333 28.330667 20.992C892.202667 493.589333 795.413333 874.56 795.413333 874.56zM266.688 938.645333c0.32 0.042667 0.448 0.042667 0.298667-0.042667 0.234667-0.042667 0.362667-0.042667-0.298667-0.042667-0.661333 0-0.533333 0-0.277333 0.042667C266.282667 938.688 266.389333 938.688 266.688 938.645333z" p-id="3214"></path></svg>
                          <b>{$OpinionDetail.LikedCount}</b>
                          <a style="display: none;">999+</a>
                          </span>
			 	      </div>
			 	    </div>
			  </div>
		  </div>
		  <!--其他用户评价-->
		  <div class="otherComment">
              {if(!(empty($OpinionDetail.Replies)))}
		      <ul>
                  {foreach($OpinionDetail.Replies as $key=>$val)}
		        <li>
		          <div class="userDetail overflow padding">
				     <img class="fl photo" src="{$Think.config.resources_site_root}/mobile/img/logo.png">
				     <h3 class="font30 top fl">匿名用户</h3>
				     <span class="grey fr top">{:toLocalDateTime($val.CreatedTime,'Y年m月d日')}</span>
		          </div>
		          <p class="font24">{$val.Content}</p>
		        </li>
		       {/foreach}
		      </ul>
              {else/}
		      <!--暂无评论-->
		      <p class="none">暂无评论，您可以点击下方"写写评论"说出您的看法</p>
              {/if}
		  </div>
		</div>
	</body>
	<script src="{$Think.config.resources_site_root}/mobile/js/jquery-2.0.3.min.js"></script>
	<script src="{$Think.config.resources_site_root}/mobile/js/detail.js"></script>
    <script src="{$Think.config.resources_site_root}/-common/js/AppEnvironment.js?v=1.2"></script>
</html>

<script>
    function zanClick(){
        $(".zan svg").click(function(){
            _this = $(this);
            var zCount= _this.next("b").text();
            var OpinionId = _this.attr('OpinionId');
            $.ajax({
                type: 'POST',
                url:AppEnvironment.apiRoot+'/apppage/Opinion/liked',
                data:{OpinionId:OpinionId},
                dataType: 'json',
                success: function(data) {
//                            alert(data)
                    console.log(data)
                    if(data==true){

                        if(_this.parent(".zan").hasClass("grey")){
                            _this.parent(".zan").removeClass("grey");
                            zCount++;
                            if(zCount>1000){
                                _this.next("b").hide().next("a").show();
                            }else{
                                _this.next("b").text(zCount);
                            }
                        }else{
                            //alert(1111);
                            _this.parent(".zan").addClass("grey");
                            zCount--;
                            _this.next("b").text(zCount);
                        }
                    }
                }
            })

        })
    }
    zanClick();
</script>
